<div class="flex justify-content-between mb-3 align-items-center">
  <div class="header font-18-px font-bold">Tạo mới sản phẩm</div>
  <div class="btn-group">
    <p-button
      label="Hủy"
      severity="secondary"
      class="mr-2"
      (onClick)="onReturn()"
    />
    <p-button label="Lưu" (onClick)="onSave()" />
  </div>
</div>
<form [formGroup]="form">
  <div class="grid">
    <div class="col-8 md:col-12 lg:col-12 xl:col-8">
      <div class="mb-4">
        <app-base-input
          formControlName="name"
          inputId="name"
          placeholder="Tên sản phẩm"
          [errors]="[
            { key: 'required', message: 'Tên sản phẩm không được để trống' }
          ]"
        ></app-base-input>
      </div>
      <div class="mb-4">
        <app-base-input
          formControlName="code"
          inputId="code"
          placeholder="Mã sản phẩm"
          [errors]="[
            { key: 'required', message: 'Mã sản phẩm không được để trống' }
          ]"
        ></app-base-input>
      </div>
      <div class="mb-4">
        <p-inputNumber
          formControlName="price"
          [min]="0"
          [max]="1000000000000"
          inputId="integeronly"
          inputId="price"
          [style]="{ width: '100%' }"
          placeholder="Giá sản phẩm"
        />
        @if (form.controls['price'].touched && form.controls['price'].errors) {
        <div class="text-error text-error-form position-absolute">
          Giá sản phẩm không được để trống
        </div>
        }
      </div>
      <div class="mb-4">
        <p-editor
          formControlName="description"
          [style]="{ height: '200px' }"
          placeholder="Mô tả sản phẩm"
        />
        @if (form.controls['description'].touched &&
        form.controls['description'].errors) {
        <div class="text-error text-error-form position-absolute">
          Mô tả về sản phẩm không được để trống
        </div>
        }
      </div>
      <div class="mb-3">
        <app-file-upload
          [visible]="visible"
          (visibleChange)="onVisibleChange($event)"
          (urlFile)="selectUrlFile($event)"
        ></app-file-upload>
        <p-button
          label="Upload"
          icon="pi pi-upload"
          (onClick)="visible = !visible"
        />
        <h3>Danh sách ảnh sản phẩm</h3>
        <p-table [value]="urls()" styleClass="p-datatable-sm">
          <ng-template pTemplate="header">
            <tr>
              <th class="text-center" style="width: 60px">STT</th>
              <th class="text-center">Ảnh</th>
              <th class="text-center" style="width: 140px">Hành động</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
            <tr>
              <td class="text-center">{{ rowIndex + 1 }}</td>
              <td>
                <img [src]="item.attachment" alt="image" width="100px" height="100px" />
              </td>
              <td class="text-center">
                <p-button
                  icon="pi pi-trash"
                  [rounded]="true"
                  [text]="true"
                  severity="danger"
                  (onClick)="deleteImage(rowIndex)"
                />
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
    <div class="col-4 md:col-12 lg:col-12 xl:col-4">
      <div class="category border-1-px surface-boder border-round mb-3">
        <div class="text-900 p-3 surface-boder border-bottom-1-px">
          Danh mục
        </div>
        <div class="select-category p-4">
          <p-multiSelect
            [options]="categories()"
            formControlName="categories"
            placeholder="Chọn danh mục"
            optionLabel="name"
            display="chip"
            [showClear]="true"
          />
          @if (form.controls['categories'].touched &&
          form.controls['categories'].errors) {
          <div class="text-error text-error-form position-absolute">
            Danh mục sản phẩm không được để trống
          </div>
          }
        </div>
      </div>
      <div class="category border-1-px surface-boder border-round mb-3">
        <div class="text-900 p-3 surface-boder border-bottom-1-px">
          Nhà cung cấp
        </div>
        <div class="select-category p-4">
          <p-dropdown
            [options]="suppliers()"
            formControlName="brand"
            [style]="{ width: '100%' }"
            placeholder="Chọn danh mục"
            optionLabel="name"
          />
          @if (form.controls['brand'].touched &&
          form.controls['brand'].errors) {
          <div class="text-error text-error-form position-absolute">
            Nhà cung cấp sản phẩm không được để trống
          </div>
          }
        </div>
      </div>
      <div class="category border-1-px surface-boder border-round">
        <div class="text-900 p-3 surface-boder border-bottom-1-px">
          Size
        </div>
        <div class="select-category p-4">
          <p-multiSelect
            [options]="sizes"
            formControlName="sizes"
            [style]="{ width: '100%' }"
            placeholder="Chọn size"
            display="chip"
            [showClear]="true"
          />
          @if (form.controls['sizes'].touched &&
          form.controls['sizes'].errors) {
          <div class="text-error text-error-form position-absolute">
            Nhà cung cấp sản phẩm không được để trống
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</form>
